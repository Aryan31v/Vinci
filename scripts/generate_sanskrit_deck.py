import genanki
import random
import os

# Define the Anki Model
MY_MODEL = genanki.Model(
    random.randrange(1 << 30, 1 << 31),
    'Sanskrit Card Model',
    fields=[
        {'name': 'Question'},
        {'name': 'Answer'},
        {'name': 'Category'},
    ],
    templates=[
        {
            'name': 'Card 1',
            'qfmt': '<div style="font-family: Arial; font-size: 20px; text-align: center; color: #2c3e50;">{{Question}}</div><br><div style="font-size: 14px; color: #7f8c8d; text-align: center;">{{Category}}</div>',
            'afmt': '{{FrontSide}}<hr id="answer"><div style="font-family: Arial; font-size: 22px; text-align: center; color: #27ae60;"><b>{{Answer}}</b></div>',
        },
    ])

def create_deck(title, cards, filename):
    deck = genanki.Deck(random.randrange(1 << 30, 1 << 31), title)
    for q, a, cat in cards:
        note = genanki.Note(
            model=MY_MODEL,
            fields=[q, a, cat]
        )
        deck.add_note(note)
    
    output_dir = "0 - Academic/Anki Decks"
    os.makedirs(output_dir, exist_ok=True)
    output_path = os.path.join(output_dir, filename)
    genanki.Package(deck).write_to_file(output_path)
    print(f"Created {output_path} with {len(cards)} cards.")

# --- DATA GENERATION ---

# 1. VIBHAKTI DATA (50 Items)
vibhakti_data = [
    ("रामः गच्छति। (रामः)", "प्रथमा (Doer)", "Vibhakti"),
    ("अहं भोजनं करोमि। (भोजनं)", "द्वितीया (Object)", "Vibhakti"),
    ("सः हस्तेन लिखति। (हस्तेन)", "तृतीया (Instrument)", "Vibhakti"),
    ("माता पुत्राय दुग्धं ददाति। (पुत्राय)", "चतुर्थी (Receiver)", "Vibhakti"),
    ("वृक्षात् पर्णं पतति। (वृक्षात्)", "पञ्चमी (Source)", "Vibhakti"),
    ("दशरथस्य पुत्रः रामः। (दशरथस्य)", "षष्ठी (Relation)", "Vibhakti"),
    ("वने सिंहः वसति। (वने)", "सप्तमी (Location)", "Vibhakti"),
    ("हे राम! अत्र आगच्छ। (हे राम)", "सम्बोधनम् (Address)", "Vibhakti"),
    ("छात्रः पुस्तकं पठति। (पुस्तकं)", "द्वितीया", "Vibhakti"),
    ("अश्वः वेगेन धावति। (वेगेन)", "तृतीया", "Vibhakti"),
    ("धनं दानाय भवति। (दानाय)", "चतुर्थी", "Vibhakti"),
    ("हिमालयात् गङ्गा प्रवहति। (हिमालयात्)", "पञ्चमी", "Vibhakti"),
    ("रामस्य पुस्तकम् अस्ति। (रामस्य)", "षष्ठी", "Vibhakti"),
    ("जले मत्स्याः तरन्ति। (जले)", "सप्तमी", "Vibhakti"),
    ("बालकः क्रीडति। (बालकः)", "प्रथमा", "Vibhakti"),
    ("अहं विद्यालयं गच्छामि। (विद्यालयं)", "द्वितीया", "Vibhakti"),
    ("सः नेत्राभ्यां पश्यति। (नेत्राभ्यां)", "तृतीया", "Vibhakti"),
    ("ज्ञानाय विद्या। (ज्ञानाय)", "चतुर्थी", "Vibhakti"),
    ("आकाशात् जलं वर्षति। (आकाशात्)", "पञ्चमी", "Vibhakti"),
    ("वृक्षस्य छाया। (वृक्षस्य)", "षष्ठी", "Vibhakti"),
    ("सभायां पण्डिताः सन्ति। (सभायां)", "सप्तमी", "Vibhakti"),
    ("सः कन्दुकेन क्रीडति। (कन्दुकेन)", "तृतीया", "Vibhakti"),
    ("गुरुः शिष्याय ज्ञानं ददाति। (शिष्याय)", "चतुर्थी", "Vibhakti"),
    ("सा ग्रामात् आगच्छति। (ग्रामात्)", "पञ्चमी", "Vibhakti"),
    ("कृष्णस्य सखा अर्जुनः। (कृष्णस्य)", "षष्ठी", "Vibhakti"),
    ("नगरे जनाः वसन्ति। (नगरे)", "सप्तमी", "Vibhakti"),
    ("मयूरः नृत्यति। (मयूरः)", "प्रथमा", "Vibhakti"),
    ("वैद्यः रुग्णं पश्यति। (रुग्णं)", "द्वितीया", "Vibhakti"),
    ("अग्निना पाकः भवति। (अग्निना)", "तृतीया", "Vibhakti"),
    ("मोक्षाय हरिं भजति। (मोक्षाय)", "चतुर्थी", "Vibhakti"),
    ("बीजात् अङ्कुरः जायते। (बीजात्)", "पञ्चमी", "Vibhakti"),
    ("सुवर्णस्य आभूषणम्। (सुवर्णस्य)", "षष्ठी", "Vibhakti"),
    ("गृहे माता अस्ति। (गृहे)", "सप्तमी", "Vibhakti"),
    ("बालिका गीतं गायति। (गीतं)", "द्वितीया", "Vibhakti"),
    ("रथेन गच्छति राजा। (रथेन)", "तृतीया", "Vibhakti"),
    ("दरिद्राय धनं देहि। (दरिद्राय)", "चतुर्थी", "Vibhakti"),
    ("मेघात् जलं पतति। (मेघात्)", "पञ्चमी", "Vibhakti"),
    ("पुष्पस्य सुगन्धः। (पुष्पस्य)", "षष्ठी", "Vibhakti"),
    ("पात्रे जलम् अस्ति। (पात्रे)", "सप्तमी", "Vibhakti"),
    ("गजः शनैः चलति। (गजः)", "प्रथमा", "Vibhakti"),
    ("अहं त्वां पश्यामि। (त्वां)", "द्वितीया", "Vibhakti"),
    ("दण्डेन ताडयति। (दण्डेन)", "तृतीया", "Vibhakti"),
    ("स्वस्थाय हितं भुङ्क्ते। (स्वस्थाय)", "चतुर्थी", "Vibhakti"),
    ("पर्वतात् नदी वहति। (पर्वतात्)", "पञ्चमी", "Vibhakti"),
    ("नदीनां जलं मधुरम्। (नदीनां)", "षष्ठी", "Vibhakti"),
    ("रात्रौ चन्द्रः उदेति। (रात्रौ)", "सप्तमी", "Vibhakti"),
    ("सैनिकः देशं रक्षति। (देशं)", "द्वितीया", "Vibhakti"),
    ("विमानेन विदेशं गच्छति। (विमानेन)", "तृतीया", "Vibhakti"),
    ("कुक्कुराय रोटिकां यच्छ। (कुक्कुराय)", "चतुर्थी", "Vibhakti"),
    ("सिंहात् भीतः। (सिंहात्)", "पञ्चमी", "Vibhakti"),
]

# 2. SHABDAROOPA DATA (50 Items)
# Generating from common tables
shabdaroopa_data = []

tables = {
    "राम (Ram)": [
        "रामः", "रामौ", "रामाः", # 1
        "रामम्", "रामौ", "रामान्", # 2
        "रामेण", "रामाभ्याम्", "रामैः", # 3
        "रामाय", "रामाभ्याम्", "रामेभ्यः", # 4
        "रामात्", "रामाभ्याम्", "रामेभ्यः", # 5
        "रामस्य", "रामयोः", "रामाणाम्", # 6
        "रामे", "रामयोः", "रामेषु" # 7
    ],
    "लता (Lata)": [
        "लता", "लते", "लताः",
        "लताम्", "लते", "लताः",
        "लतया", "लताभ्याम्", "लताभिः",
        "लतायै", "लताभ्याम्", "लताभ्यः",
        "लतायाः", "लताभ्याम्", "लताभ्यः",
        "लतायाः", "लतयोः", "लतानाम्",
        "लतायाम्", "लतयोः", "लतासु"
    ],
    "फल (Phal)": [
        "फलम्", "फले", "फलानि",
        "फलम्", "फले", "फलानि",
        "फलेन", "फलाभ्याम्", "फलैः",
        "फलाय", "फलाभ्याम्", "फलेभ्यः",
        "फलात्", "फलाभ्याम्", "फलेभ्यः",
        "फलस्य", "फलयोः", "फलानाम्",
        "फले", "फलयोः", "फलेषु"
    ]
}

cases = ["Prathama", "Dwitiya", "Tritiya", "Chaturthi", "Panchami", "Shashti", "Saptami"]
numbers = ["Ekavachana", "Dwivachana", "Bahuvachana"]

# Generate systematically
count = 0
for word, forms in tables.items():
    for i, form in enumerate(forms):
        case_idx = i // 3
        num_idx = i % 3
        q = f"{word} - {cases[case_idx]}, {numbers[num_idx]}"
        a = form
        shabdaroopa_data.append((q, a, "Shabdaroopa"))
        count += 1
        if count >= 50: break
    if count >= 50: break

# Add a few manual specific ones if loop didn't fill 50 (it will fill ~63 so we trim)
shabdaroopa_data = shabdaroopa_data[:50]


# 3. SAMASA DATA (50 Items)
samasa_data = [
    ("पीताम्बरः", "पीतम् अम्बरं यस्य सः (बहुव्रीहिः)", "Samasa"),
    ("नीलकण्ठः", "नीलः कण्ठः यस्य सः (बहुव्रीहिः)", "Samasa"),
    ("लम्बोदरः", "लम्बम् उदरं यस्य सः (बहुव्रीहिः)", "Samasa"),
    ("चक्रपाणिः", "चक्रं पाणौ यस्य सः (बहुव्रीहिः)", "Samasa"),
    ("दशाननः", "दश आननानि यस्य सः (बहुव्रीहिः)", "Samasa"),
    ("राजपुरुषः", "राज्ञः पुरुषः (षष्ठी तत्पुरुषः)", "Samasa"),
    ("देवालयः", "देवस्य आलयः (षष्ठी तत्पुरुषः)", "Samasa"),
    ("वृक्षपतितः", "वृक्षात् पतितः (पञ्चमी तत्पुरुषः)", "Samasa"),
    ("धनहीनः", "धनेन हीनः (तृतीया तत्पुरुषः)", "Samasa"),
    ("पापमुक्तः", "पापात् मुक्तः (पञ्चमी तत्पुरुषः)", "Samasa"),
    ("मातापितरौ", "माता च पिता च (इतरेतर द्वन्द्वः)", "Samasa"),
    ("रामलक्ष्मणौ", "रामः च लक्ष्मणः च (इतरेतर द्वन्द्वः)", "Samasa"),
    ("हरिहरौ", "हरिः च हरः च (इतरेतर द्वन्द्वः)", "Samasa"),
    ("पाणिपादम्", "पाणी च पादौ च (समाहार द्वन्द्वः)", "Samasa"),
    ("सुखदुःखम्", "सुखं च दुःखं च (समाहार द्वन्द्वः)", "Samasa"),
    ("यथाशक्ति", "शक्तिम् अनतिक्रम्य (अव्ययीभावः)", "Samasa"),
    ("प्रतिदिनम्", "दिनं दिनं प्रति (अव्ययीभावः)", "Samasa"),
    ("उपकृष्णम्", "कृष्णस्य समीपम् (अव्ययीभावः)", "Samasa"),
    ("निर्धऩम्", "धनानां अभावः (अव्ययीभावः - exceptions vary)", "Samasa"),
    ("सचित्रम्", "चित्रेण सहितम् (अव्ययीभावः)", "Samasa"),
    ("महानदी", "महती नदी (कर्मधारयः)", "Samasa"),
    ("नीलकमलम्", "नीलं कमलम् (कर्मधारयः)", "Samasa"),
    ("कृष्णसर्पः", "कृष्णः सर्पः (कर्मधारयः)", "Samasa"),
    ("महापुरुषः", "हान् पुरुषः (कर्मधारयः)", "Samasa"),
    ("घनश्यामः", "घनः इव श्यामः (कर्मधारयः)", "Samasa"),
    ("त्रिलोकी", "त्रयाणां लोकानां समाहारः (द्विगुः)", "Samasa"),
    ("पञ्चवटी", "पञ्चानां वटानां समाहारः (द्विगुः)", "Samasa"),
    ("नवरत्नम्", "नवानां रत्नानां समाहारः (द्विगुः)", "Samasa"),
    ("शताब्दी", "शतानां अब्दानां समाहारः (द्विगुः)", "Samasa"),
    ("त्रिभुवनम्", "त्रयाणां भुवनानां समाहारः (द्विगुः)", "Samasa"),
    ("कुपुत्रः", "कुत्सितः पुत्रः (प्रादि तत्पुरुषः/कर्मधारय)", "Samasa"),
    ("सुपुत्रः", "शोभनः पुत्रः (प्रादि तत्पुरुषः/कर्मधारय)", "Samasa"),
    ("प्राचार्यः", "प्रगतः आचार्यः (प्रादि तत्पुरुषः)", "Samasa"),
    ("अधर्मः", "न धर्मः (नञ् तत्पुरुषः)", "Samasa"),
    ("असत्यम्", "न सत्यम् (नञ् तत्पुरुषः)", "Samasa"),
    ("अज्ञानम्", "न ज्ञानम् (नञ् तत्पुरुषः)", "Samasa"),
    ("अनुचितम्", "न उचितम् (नञ् तत्पुरुषः)", "Samasa"),
    ("अनादिः", "न आदिः यस्य सः (नञ् बहुव्रीहिः)", "Samasa"),
    ("विद्याधनम्", "विद्या एव धनम् (रूपक कर्मधारयः)", "Samasa"),
    ("नरसिंहः", "नरः सिंहः इव (उपमित कर्मधारयः)", "Samasa"),
    ("चन्द्रमुखम्", "चन्द्रः इव मुखम् (उपमित कर्मधारयः)", "Samasa"),
    ("कमलनयनम्", "कमलम् इव नयनम् (उपमित कर्मधारयः)", "Samasa"),
    ("युधिष्ठिरः", "युधि स्थिरः (अलुक् तत्पुरुषः)", "Samasa"),
    ("सरसिजम्", "सरसि जायते इति (उपपद तत्पुरुषः)", "Samasa"),
    ("कुम्भकारः", "कुम्भं करोति इति (उपपद तत्पुरुषः)", "Samasa"),
    ("जलदः", "जलं ददाति इति (उपपद तत्पुरुषः)", "Samasa"),
    ("पङ्कजम्", "पङ्के जायते इति (उपपद तत्पुरुषः)", "Samasa"),
    ("धर्मार्थौ", "धर्मः च अर्थः च (द्वन्द्वः)", "Samasa"),
    ("शीतोष्णम्", "शीतं च उष्णं च (द्वन्द्वः)", "Samasa"),
    ("अहोरात्रः", "अहः च रात्रिश्च (द्वन्द्वः)", "Samasa")
]

# Create Decks
create_deck("Sanskrit - Vibhakti (Grammar)", vibhakti_data, "Sanskrit_Vibhakti.apkg")
create_deck("Sanskrit - Shabdaroopa (Declensions)", shabdaroopa_data, "Sanskrit_Shabdaroopa.apkg")
create_deck("Sanskrit - Samasa (Compounds)", samasa_data, "Sanskrit_Samasa.apkg")
